# Справочник полей API интеграции 1С

## Быстрая справка для программиста 1С

---

## Структура запроса

```
{
  "token": "строка",
  "products": [
    {
      // Объект товара (см. таблицу ниже)
    }
  ]
}
```

---

## Поля товара

### Обязательные поля

| Поле | Тип | Формат | Пример | Описание |
|------|-----|--------|--------|----------|
| `sku` | String | Текст | `"ART001"` | Артикул товара (уникальный идентификатор) |
| `name` | String | Текст | `"Товар 1"` | Название товара |
| `price` | Decimal | Число с точкой | `1000.00` | Цена товара (>= 0) |

### Опциональные поля

| Поле | Тип | Формат | Пример | По умолчанию | Описание |
|------|-----|--------|--------|--------------|----------|
| `description` | String | Текст | `"Описание"` | `""` | Полное описание товара |
| `old_price` | Decimal | Число с точкой | `1500.00` | `null` | Старая цена (должна быть > price) |
| `stock` | Integer | Целое число | `10` | `0` | Остаток на складе (>= 0) |
| `category` | String | Текст | `"Категория 1"` | `null` | Название категории |
| `characteristics` | Array | Массив объектов | `[{...}]` | `[]` | Массив характеристик |
| `is_active` | Boolean | true/false | `true` | `true` | Активен ли товар |

---

## Поля характеристики товара

| Поле | Тип | Формат | Пример | Обязательное |
|------|-----|--------|--------|--------------|
| `name` | String | Текст | `"Цвет"` | Да |
| `value` | String | Текст | `"Красный"` | Да |

---

## Типы данных

### String (Строка)
- **Формат:** Текст в кавычках
- **Примеры:** `"Текст"`, `"123"`, `""`
- **Кодировка:** UTF-8

### Decimal (Число с дробной частью)
- **Формат:** Число с точкой как разделителем
- **Примеры:** `1000.00`, `1000.50`, `0.99`
- **НЕ используйте:** `1000,00` (запятая)
- **Минимум:** `0`

### Integer (Целое число)
- **Формат:** Целое число без дробной части
- **Примеры:** `0`, `10`, `100`
- **Минимум:** `0`

### Boolean (Логическое значение)
- **Формат:** `true` или `false` (без кавычек)
- **Примеры:** `true`, `false`
- **НЕ используйте:** `"true"`, `"false"`, `1`, `0`

### Array (Массив)
- **Формат:** `[элемент1, элемент2, ...]`
- **Примеры:** `[]`, `[1, 2, 3]`, `[{"name": "Цвет", "value": "Красный"}]`

---

## Ограничения длины полей

| Поле | Максимальная длина |
|------|-------------------|
| `sku` | 100 символов |
| `name` | 500 символов |
| `description` | Без ограничений |
| `category` | 200 символов |
| `characteristics[].name` | 200 символов |
| `characteristics[].value` | 500 символов |

---

## Правила валидации

### Цены
- ✅ `price >= 0`
- ✅ `old_price >= 0` (если указана)
- ✅ `old_price > price` (если указана)
- ✅ Разделитель дробной части: точка (`.`)

### Остатки
- ✅ `stock >= 0`
- ✅ Целое число

### Характеристики
- ✅ Если указано поле `characteristics`, оно должно быть массивом
- ✅ Каждый элемент должен иметь `name` и `value`
- ✅ `name` не может быть пустым
- ✅ `value` не может быть пустым

---

## Примеры значений

### Минимальный товар
```json
{
  "sku": "ART001",
  "name": "Товар 1",
  "price": 1000.00
}
```

### Товар с ценой и остатком
```json
{
  "sku": "ART001",
  "name": "Товар 1",
  "price": 1000.00,
  "stock": 10
}
```

### Товар со скидкой
```json
{
  "sku": "ART001",
  "name": "Товар 1",
  "price": 1000.00,
  "old_price": 1500.00,
  "stock": 10
}
```

### Товар с категорией
```json
{
  "sku": "ART001",
  "name": "Товар 1",
  "price": 1000.00,
  "category": "Категория 1"
}
```

### Товар с характеристиками
```json
{
  "sku": "ART001",
  "name": "Товар 1",
  "price": 1000.00,
  "characteristics": [
    {
      "name": "Цвет",
      "value": "Красный"
    },
    {
      "name": "Материал",
      "value": "Металл"
    }
  ]
}
```

### Полный товар
```json
{
  "sku": "ART001",
  "name": "Товар 1",
  "description": "Подробное описание",
  "price": 1000.00,
  "old_price": 1500.00,
  "stock": 10,
  "category": "Категория 1",
  "characteristics": [
    {
      "name": "Цвет",
      "value": "Красный"
    }
  ],
  "is_active": true
}
```

---

## Структура ответа

### Успешный ответ
```json
{
  "status": "success",
  "processed": 10,
  "created": 3,
  "updated": 7,
  "errors": []
}
```

### Поля ответа

| Поле | Тип | Описание |
|------|-----|----------|
| `status` | String | `"success"`, `"partial"` или `"error"` |
| `processed` | Integer | Общее количество товаров в запросе |
| `created` | Integer | Количество созданных товаров |
| `updated` | Integer | Количество обновленных товаров |
| `errors` | Array | Массив ошибок (пустой при успехе) |

---

## HTTP коды ответов

| Код | Статус | Описание |
|-----|--------|----------|
| 200 | success | Все товары обработаны успешно |
| 207 | partial | Часть товаров обработана, есть ошибки |
| 400 | error | Ошибка валидации данных |
| 401 | error | Неверный токен авторизации |
| 500 | error | Внутренняя ошибка сервера |

---

## Контрольный список

Перед отправкой проверьте:

- [ ] Токен указан и корректен
- [ ] `products` - массив с минимум 1 элементом
- [ ] В каждом товаре есть `sku`, `name`, `price`
- [ ] `price` - число (не строка), >= 0
- [ ] `stock` - целое число (не строка), >= 0
- [ ] `is_active` - `true` или `false` (не строка)
- [ ] Если `old_price` указана, то `old_price` > `price`
- [ ] Характеристики имеют `name` и `value`
- [ ] Кодировка: UTF-8
- [ ] Content-Type: `application/json; charset=utf-8`

---

## Endpoints

| Endpoint | Метод | Описание |
|----------|-------|-----------|
| `/api/1c/sync/` | POST | API синхронизация (JSON) |
| `/api/1c/upload/` | POST | Загрузка файлов (CSV/XML/JSON) |

---

## Аутентификация

**Способ 1:** В заголовке
```
X-API-Key: ваш-токен
```

**Способ 2:** В теле запроса
```json
{
  "token": "ваш-токен",
  "products": [...]
}
```

---

## Логика обработки

1. **Поиск товара:** По полю `sku` (артикул)
2. **Если найден:** Обновление существующего товара
3. **Если не найден:** Создание нового товара
4. **Характеристики:** Старые удаляются, новые создаются
5. **Категория:** Создается автоматически, если не существует
6. **Наличие:** Обновляется автоматически на основе `stock`

---

## Рекомендации

- Отправляйте не более 100-200 товаров за раз
- При больших объемах разбивайте на несколько запросов
- Проверяйте ответы и обрабатывайте ошибки
- Логируйте результаты для анализа
